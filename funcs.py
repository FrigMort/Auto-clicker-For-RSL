import time
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium.webdriver.common.action_chains import ActionChains
import os
import sup
from datetime import datetime
import pyautogui

def authAndDownload():
    try:
        os.remove(r"C:\Users\CyberV-5\Downloads\RaidSetup.exe")
    except Exception as err:
        print("Этот файл клиента уже удален")
    lp = open('info.txt', 'r')
    for line in lp:
        lap = line.replace("\n", '')
        email = lap.partition(':')[0].replace("\n", '')
        e = f"{email}"
        password = lap.partition(':')[2].replace("\n", '')
        p= f"{password}"
        login = email.partition("@")[0].replace("\n", '')
        login.replace('\v', '')
        l = f"{login}"
        print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Запуск браузера")
        driver = webdriver.Chrome("models\chromedriver.exe")
        driver.get("https://plarium.com/landings/ru/desktop/raid/pc_galek_001?plid=379739&publisherId=PsihopatySindikata-Package17&placement=&pxl=&inviterId=um000")
        name = driver.find_element("name","userName")
        password = driver.find_element("name", "password")
        email  = driver.find_element("name", "email")
        print("Ввод данных.......")
        name.send_keys(l)
        password.send_keys(p)
        email.send_keys(e)
        pyautogui.moveTo(146, 400)
        pyautogui.click()
        pyautogui.moveTo(225, 458)
        pyautogui.click()
        pyautogui.PAUSE = 3
        pyautogui.moveTo(415, 989)
        pyautogui.click()
        pyautogui.moveTo(188, 996)
        pyautogui.click(button="right")
        pyautogui.moveTo(254, 884)
        pyautogui.click()
        driver.close()
        print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Регестрация и установка окончена!")
        sup.manipilationOfFiles()


        break

def launch_Client():
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Запуск клиента...")
    os.system(r"C:\Users\CyberV-5\Downloads\RaidSetup.exe")
    time.sleep(20)
    



def learn():
    pyautogui.click(440, 347)
    time.sleep(2)
    pyautogui.click(1468, 200)
    time.sleep(62)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} First fight")
    pyautogui.click(810, 540)
    pyautogui.click(810, 540)
    pyautogui.click(810, 540)
    pyautogui.click(810, 540)
    pyautogui.click(810, 540)
    pyautogui.click(810, 540)
    pyautogui.click(810, 540)
    pyautogui.click(1120, 452)
    time.sleep(8)
    pyautogui.click(1120, 452)
    pyautogui.click(1120, 452)
    pyautogui.click(1120, 452)
    pyautogui.click(1120, 452)
    pyautogui.click(1258, 426)
    time.sleep(7)
    pyautogui.click(1120, 452)
    pyautogui.click(1120, 452)
    pyautogui.click(1120, 452)
    pyautogui.click(1350, 863)
    pyautogui.click(1120, 452)
    pyautogui.click(1120, 452)
    pyautogui.click(1258, 426)
    time.sleep(3)
    pyautogui.click(1120, 452)
    pyautogui.click(1120, 452)
    pyautogui.click(1120, 452)
    time.sleep(5)
    pyautogui.click(1120, 452)
    time.sleep(5)
    pyautogui.click(1120, 452)
    time.sleep(9)
    pyautogui.click(1120, 452)
    pyautogui.click(1120, 452)
    pyautogui.click(1120, 452)
    time.sleep(17)
    pyautogui.click(840, 500)
    pyautogui.click(840, 500)
    pyautogui.click(795, 838)
    time.sleep(10)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(850, 530)
    pyautogui.click(791, 840)
    pyautogui.click(1527, 776)
    
    time.sleep(8)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Выбор героя")
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    time.sleep(2)
    pyautogui.click(838, 593)
    time.sleep(1)
    pyautogui.click(838, 834)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Выбран")
    time.sleep(8)
    pyautogui.click(1527, 776)
    pyautogui.click(1544, 173)
    time.sleep(1)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Главное меню")
    pyautogui.click(1544, 173)
    pyautogui.click(1544, 173)
    time.sleep(2)
    print("Скип")
    pyautogui.click(1448, 888)
    time.sleep(2)
    pyautogui.click(515, 580)
    time.sleep(2)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Открытие шарда")
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(935, 538)
    time.sleep(2)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Открываеться")
    pyautogui.click(981, 882)
    time.sleep(6)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Получение новго персонажа")
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    time.sleep(2)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Переход на главную")
    pyautogui.click(1525, 170)
    pyautogui.click(1525, 170)
    time.sleep(2)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Главное меню")
    pyautogui.click(1425, 873)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Подготовка к второму файту")
    time.sleep(2)
    pyautogui.click(515, 566)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(935, 538)
    pyautogui.click(935, 538)
    pyautogui.click(935, 538)
    pyautogui.click(935, 538)
    pyautogui.click(935, 538)
    pyautogui.click(935, 538)
    time.sleep(2)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Лор")
    pyautogui.click(955, 799)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    time.sleep(2)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Настройка места битвы и трата энгергии")
    pyautogui.click(1527, 776)
    pyautogui.click(1436, 278)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Выбор песонажей")
    time.sleep(2)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(393, 758)
    pyautogui.click(393, 872)
    pyautogui.click(478, 217)
    pyautogui.click(1430, 877)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Начало второго файта")
    time.sleep(3)
    pyautogui.click(1527, 776)
    pyautogui.click(383, 871)
    pyautogui.click(492, 880)
    time.sleep(27)
    print("Конец файта")
    pyautogui.click(1527, 776)
    pyautogui.click(907, 390)
    time.sleep(2)
    pyautogui.click(1527, 776)
    pyautogui.click(1268, 344)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(386, 879)
    pyautogui.click(386, 879)
    pyautogui.click(386, 879)
    time.sleep(3)
    pyautogui.click(1527, 776)
    pyautogui.click(1298, 892)
    time.sleep(2)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1325, 336)
    time.sleep(2)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Setup knife")
    pyautogui.click(706, 456)
    print("Equip")
    pyautogui.click(581, 883)
    time.sleep(3)
    pyautogui.click(1527, 776)
    pyautogui.click(1535, 182)
    time.sleep(2)
    pyautogui.click(1435, 885)
    pyautogui.click(1435, 885)
    pyautogui.click(1435, 885)
    pyautogui.click(1435, 885)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Подготовка к 3-ему файту")
    time.sleep(2)
    pyautogui.click(515, 566)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(935, 538)
    pyautogui.click(935, 538)
    pyautogui.click(935, 538)
    pyautogui.click(935, 538)
    pyautogui.click(935, 538)
    pyautogui.click(935, 538)
    time.sleep(2)
    pyautogui.click(1455, 413)
    pyautogui.click(1425, 873)
    time.sleep(31)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Конец 3 файта")
    pyautogui.click(1527, 776)
    pyautogui.click(1527, 776)
    pyautogui.click(386, 889)
    time.sleep(2)
    pyautogui.click(386, 889)
    pyautogui.click(386, 889)
    time.sleep(2)
    pyautogui.click(1285, 877)
    pyautogui.click(1285, 877)
    time.sleep(2)
    pyautogui.click(1423, 346)
    time.sleep(2)
    pyautogui.click(720, 465)
    pyautogui.click(720, 465)
    pyautogui.click(720, 465)
    print("Equip")
    pyautogui.click(581, 883)
    time.sleep(2)
    pyautogui.click(1228, 200)
    pyautogui.click(1173, 347)
    pyautogui.click(1427, 347)
    pyautogui.click(403, 509)
    time.sleep(2)
    pyautogui.click(823, 857)
    time.sleep(2)
    pyautogui.click(823, 857)
    time.sleep(2)
    pyautogui.click(823, 857)
    time.sleep(2)
    pyautogui.click(823, 857)
    time.sleep(2)
    pyautogui.click(1525, 762)
    pyautogui.click(1543, 182)
    time.sleep(2)
    pyautogui.click(1543, 182)
    time.sleep(2)
    pyautogui.click(1525, 762)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Конец обучения")
    time.sleep(2)
    pyautogui.click(598, 781)
    print(f"{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())} Сбор наград")
    time.sleep(2)
    pyautogui.click(1397, 229)
    pyautogui.click(1541, 228)
    pyautogui.click(1541, 228)
    time.sleep(2)
    pyautogui.click(1466, 200)
    pyautogui.click(1349, 335)
    time.sleep(2)
    pyautogui.click(1349, 335)
    time.sleep(1)
    pyautogui.click(1349, 335)
    time.sleep(1)
    pyautogui.click(1349, 335)
    time.sleep(1)
    pyautogui.click(1349, 335)
    time.sleep(1)
    pyautogui.click(1349, 335)
    time.sleep(1)
    pyautogui.click(1349, 335)
    time.sleep(1)

if __name__ == "__main__":
    authAndDownload()
    launch_Client()
    learn()

